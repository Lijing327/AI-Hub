# é™„ä»¶åŠŸèƒ½ç°çŠ¶ä¸é—®é¢˜åˆ†æ

## ğŸ“Œ æ‰§è¡Œæ‘˜è¦

**æ ¸å¿ƒé—®é¢˜**ï¼šExcel å¯¼å…¥æ—¶ï¼Œä¸€ä¸ªå•å…ƒæ ¼åŒ…å«å¤šä¸ªé™„ä»¶å¼•ç”¨ï¼ˆå¦‚ï¼š`å‚è€ƒ"xxx"\nå‚è€ƒ"yyy"\nå‚è€ƒ"zzz"`ï¼‰ï¼Œä½†ç³»ç»Ÿåªåˆ›å»ºäº†éƒ¨åˆ†é™„ä»¶è®°å½•ï¼Œå¯¼è‡´å‰ç«¯æ˜¾ç¤ºä¸å®Œæ•´ã€‚

**æŠ€æœ¯æ ˆ**ï¼š
- åç«¯ï¼š.NET 8 WebAPI + SQL Server
- Python æœåŠ¡ï¼šFastAPIï¼ˆExcel è§£æå’Œæ–‡ä»¶åŒ¹é…ï¼‰
- å‰ç«¯ï¼šVue3 + TypeScript

**å…³é”®å‘ç°**ï¼š
1. æ–‡ä»¶ç¡®å®å­˜åœ¨äºç›®å½•ä¸­ï¼Œä½†åŒ¹é…å¤±è´¥
2. å¤šå¼•ç”¨æå–é€»è¾‘å·¥ä½œæ­£å¸¸ï¼ˆèƒ½æ£€æµ‹åˆ°å¤šä¸ªå¼•ç”¨ï¼‰
3. ä½†æ–‡ä»¶åŒ¹é…å¯èƒ½åªæ‰¾åˆ°äº†éƒ¨åˆ†æ–‡ä»¶
4. é™„ä»¶è®°å½•åˆ›å»ºæˆåŠŸï¼Œä½†æ•°é‡ä¸å®Œæ•´

**éœ€è¦ ChatGPT å¸®åŠ©åˆ†æ**ï¼š
1. ä¸ºä»€ä¹ˆæ–‡ä»¶åŒ¹é…å¤±è´¥ï¼ˆæ–‡ä»¶å­˜åœ¨ä½†æ‰¾ä¸åˆ°ï¼‰ï¼Ÿ
2. å¤šå¼•ç”¨å¤„ç†é€»è¾‘æ˜¯å¦æœ‰é—æ¼ï¼Ÿ
3. å¦‚ä½•æ”¹è¿›æ–‡ä»¶åŒ¹é…çš„å‡†ç¡®æ€§ï¼Ÿ
4. å¦‚ä½•ç¡®ä¿æ‰€æœ‰æ‰¾åˆ°çš„æ–‡ä»¶éƒ½åˆ›å»ºé™„ä»¶è®°å½•ï¼Ÿ

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å®ç°äº†ä¸€ä¸ª Excel å¯¼å…¥ç³»ç»Ÿï¼Œèƒ½å¤Ÿï¼š
1. è§£æ Excel æ–‡ä»¶ï¼Œæå–çŸ¥è¯†æ¡ç›®
2. ä» Excel çš„"ç»´ä¿®è§†é¢‘ï¼ˆé™„ä»¶ï¼‰"åˆ—ä¸­æå–é™„ä»¶å¼•ç”¨ï¼ˆå¦‚ï¼š`å‚è€ƒ"é—¨é™ä½å¿«é€ŸçŸ­æ¥"`ï¼‰
3. åœ¨å›ºå®šç›®å½•ï¼ˆ`D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘`ï¼‰ä¸­æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶
4. è‡ªåŠ¨åˆ›å»ºé™„ä»¶è®°å½•åˆ°æ•°æ®åº“ï¼ˆ`kb_asset` è¡¨ï¼‰
5. å‰ç«¯æ˜¾ç¤ºé™„ä»¶åˆ—è¡¨

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯ï¼ˆ.NETï¼‰
- **æ¡†æ¶**: ASP.NET Core 8 WebAPI
- **æ•°æ®åº“**: SQL Server 2019+
- **è¡¨ç»“æ„**: `kb_article`ï¼ˆçŸ¥è¯†æ¡ç›®ï¼‰ã€`kb_asset`ï¼ˆé™„ä»¶è®°å½•ï¼‰
- **APIç«¯ç‚¹**: 
  - `POST /api/ai/kb/articles/batch` - æ‰¹é‡åˆ›å»ºæ–‡ç« 
  - `POST /api/ai/kb/articles/assets/batch` - æ‰¹é‡åˆ›å»ºé™„ä»¶è®°å½•

### Python æœåŠ¡ï¼ˆFastAPIï¼‰
- **åŠŸèƒ½**: Excel è§£æå’Œæ–‡ä»¶åŒ¹é…
- **æ–‡ä»¶åŒ¹é…**: é€’å½’æœç´¢ç›®å½•ï¼Œæ”¯æŒç²¾ç¡®åŒ¹é…ã€æ¨¡ç³ŠåŒ¹é…ã€æ–‡ä»¶å¤¹åç§°åŒ¹é…
- **APIç«¯ç‚¹**: `POST /import/excel`

### å‰ç«¯ï¼ˆVue3ï¼‰
- **æ˜¾ç¤º**: çŸ¥è¯†è¯¦æƒ…é¡µé¢æ˜¾ç¤ºé™„ä»¶åˆ—è¡¨
- **API**: `GET /api/knowledgeitems/{id}` è¿”å›åŒ…å« `assets` å­—æ®µçš„æ•°æ®

## âœ… å½“å‰å®ç°çŠ¶æ€

### å·²å®ç°çš„åŠŸèƒ½

1. **å¤šå¼•ç”¨æå–**
   - æ”¯æŒä¸€ä¸ªå•å…ƒæ ¼åŒ…å«å¤šä¸ªå¼•ç”¨ï¼ˆæ¢è¡Œç¬¦ã€åˆ†å·åˆ†éš”ï¼‰
   - ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–æ‰€æœ‰ `å‚è€ƒ"xxx"` æ ¼å¼çš„å¼•ç”¨

2. **æ–‡ä»¶åŒ¹é…ç­–ç•¥ï¼ˆä¸‰çº§ï¼‰**
   - **ç¬¬ä¸€çº§**: ç²¾ç¡®åŒ¹é…æ–‡ä»¶åï¼ˆä¼˜å…ˆæ£€æŸ¥æ ¹ç›®å½•ï¼‰
   - **ç¬¬äºŒçº§**: æ¨¡ç³ŠåŒ¹é…ï¼ˆæ–‡ä»¶ååŒ…å«å…³é”®å­—ï¼‰
   - **ç¬¬ä¸‰çº§**: æ–‡ä»¶å¤¹åç§°åŒ¹é…ï¼ˆå¦‚æœæ–‡ä»¶åœ¨åŒ¹é…åç§°çš„æ–‡ä»¶å¤¹ä¸­ï¼‰

3. **æ‰¹é‡åˆ›å»ºé™„ä»¶**
   - æ”¯æŒä¸€ä¸ªæ–‡ç« å…³è”å¤šä¸ªé™„ä»¶
   - è‡ªåŠ¨åˆ›å»ºé™„ä»¶è®°å½•åˆ°æ•°æ®åº“
   - åŒ…å«è¯¦ç»†çš„æ—¥å¿—è®°å½•

4. **URLç¼–ç **
   - æ”¯æŒä¸­æ–‡è·¯å¾„çš„URLç¼–ç 
   - ç”Ÿæˆæ­£ç¡®çš„æ–‡ä»¶è®¿é—®URL

## âš ï¸ å½“å‰å­˜åœ¨çš„é—®é¢˜

### é—®é¢˜ 1ï¼šé™„ä»¶è®°å½•åˆ›å»ºä¸å®Œæ•´

**ç°è±¡**:
- Excel ä¸­ä¸€ä¸ªå•å…ƒæ ¼æœ‰ 3 ä¸ªå¼•ç”¨ï¼ˆå¦‚ï¼š`å‚è€ƒ"141æ²¹æ³µé˜»å°¼æ‹†å¸"`ã€`å‚è€ƒ"141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥"`ã€`å‚è€ƒ"141æ³µé«˜ä½å‹é˜€æ‹†è§£"`ï¼‰
- æ—¥å¿—æ˜¾ç¤º"æ£€æµ‹åˆ° 3 ä¸ªå¼•ç”¨"
- ä½†æœ€ç»ˆåªåˆ›å»ºäº† 1 ä¸ªé™„ä»¶è®°å½•
- å‰ç«¯åªæ˜¾ç¤º 1 ä¸ªé™„ä»¶

**æ—¥å¿—ç¤ºä¾‹**:
```
INFO:__main__:æ£€æµ‹åˆ° 3 ä¸ªå¼•ç”¨ï¼Œå°†å°è¯•åŒ¹é…æ‰€æœ‰å¼•ç”¨
INFO:__main__:æ‰¾åˆ°é™„ä»¶æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹åŒ…å«åŒ¹é…ï¼‰: "141æ³µé«˜ä½å‹é˜€æ‹†è§£" -> æ–‡ä»¶å¤¹[141æ³µé«˜ä½å‹é˜€æ‹†è§£]/2.mp4
INFO:__main__:âœ“ æ‰¾åˆ°é™„ä»¶æ–‡ä»¶: "141æ³µé«˜ä½å‹é˜€æ‹†è§£" -> http://localhost:5000/uploads/...
INFO:__main__:å‡†å¤‡åˆ›å»º 6 ä¸ªé™„ä»¶è®°å½•ï¼ˆæ¶‰åŠ 5 ç¯‡æ–‡ç« ï¼‰
INFO:__main__:  æ–‡ç«  ID 348: 1 ä¸ªé™„ä»¶  â† åº”è¯¥æ˜¯ 3 ä¸ªé™„ä»¶
INFO:__main__:âœ… é™„ä»¶åˆ›å»ºç»“æœ: æˆåŠŸ 6 ä¸ªï¼Œå¤±è´¥ 0 ä¸ª
```

**å¯èƒ½çš„åŸå› **:
1. æ–‡ä»¶åŒ¹é…é€»è¾‘åªæ‰¾åˆ°äº†éƒ¨åˆ†æ–‡ä»¶ï¼ˆå…¶ä»– 2 ä¸ªå¼•ç”¨æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ–‡ä»¶ï¼‰
2. å¤šå¼•ç”¨æå–é€»è¾‘æœ‰é—®é¢˜ï¼Œåªæå–äº†ç¬¬ä¸€ä¸ªå¼•ç”¨
3. é™„ä»¶ä¿¡æ¯æ”¶é›†é€»è¾‘æœ‰é—®é¢˜ï¼Œåªä¿å­˜äº†ç¬¬ä¸€ä¸ªé™„ä»¶

### é—®é¢˜ 2ï¼šæ–‡ä»¶ç¡®å®å­˜åœ¨ä½†åŒ¹é…å¤±è´¥

**ç°è±¡**:
- ç”¨æˆ·ç¡®è®¤æ–‡ä»¶å­˜åœ¨äºç›®å½•ä¸­ï¼ˆå¦‚ï¼š`400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®.docx`ã€`å°„ç ‚è„‰å†²é˜€çš„æ¸…ç†.mp4`ï¼‰
- ä½†å¯¼å…¥æ—¶æ—¥å¿—æ˜¾ç¤º"æœªæ‰¾åˆ°é™„ä»¶æ–‡ä»¶"
- è¿™äº›æ–‡ä»¶åœ¨æ ¹ç›®å½•ä¸‹ï¼Œä¸åœ¨å­æ–‡ä»¶å¤¹ä¸­

**æ–‡ä»¶ä½ç½®ç¤ºä¾‹**:
```
D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\
  â”œâ”€â”€ 400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®.docx  â† æ ¹ç›®å½•
  â”œâ”€â”€ å°„ç ‚è„‰å†²é˜€çš„æ¸…ç†.mp4          â† æ ¹ç›®å½•
  â”œâ”€â”€ åŠ ç ‚çƒé˜€æ¸…æŒ¤ç ‚/                â† å­æ–‡ä»¶å¤¹
  â”‚   â””â”€â”€ æ‹†ä¸‹æ³•å…°.jpg
  â””â”€â”€ 141æ³µé«˜ä½å‹é˜€æ‹†è§£/             â† å­æ–‡ä»¶å¤¹
      â””â”€â”€ 2.mp4
```

**å¯èƒ½çš„åŸå› **:
1. æ–‡ä»¶åæå–æ—¶å¼•å·å¤„ç†æœ‰é—®é¢˜
2. æ–‡ä»¶åŒ¹é…æ—¶å¤§å°å†™æˆ–ç¼–ç é—®é¢˜
3. æ ¹ç›®å½•æ–‡ä»¶åŒ¹é…é€»è¾‘ä¼˜å…ˆçº§ä¸å¤Ÿ

### é—®é¢˜ 3ï¼šé™„ä»¶è®°å½•åˆ›å»ºæˆåŠŸä½†å‰ç«¯ä¸æ˜¾ç¤º

**ç°è±¡**:
- æ—¥å¿—æ˜¾ç¤ºé™„ä»¶åˆ›å»ºæˆåŠŸï¼ˆ`âœ… é™„ä»¶åˆ›å»ºç»“æœ: æˆåŠŸ 6 ä¸ª`ï¼‰
- æ•°æ®åº“ä¸­æœ‰é™„ä»¶è®°å½•
- ä½†å‰ç«¯çŸ¥è¯†è¯¦æƒ…é¡µé¢æ˜¾ç¤º"æš‚æ— é™„ä»¶"

**å¯èƒ½çš„åŸå› **:
1. ç§Ÿæˆ·IDä¸åŒ¹é…ï¼ˆåˆ›å»ºæ—¶å’ŒæŸ¥è¯¢æ—¶ä¸ä¸€è‡´ï¼‰
2. é™„ä»¶è¢«è½¯åˆ é™¤ï¼ˆ`deleted_at` ä¸ä¸ºç©ºï¼‰
3. å‰ç«¯APIè¿”å›çš„æ•°æ®ç»“æ„ä¸åŒ¹é…
4. å‰ç«¯æ²¡æœ‰æ­£ç¡®åŠ è½½é™„ä»¶åˆ—è¡¨

### é—®é¢˜ 4ï¼šå¤šå¼•ç”¨å¤„ç†é€»è¾‘ä¸æ¸…æ™°

**å½“å‰å®ç°**:
```python
# å¦‚æœåªæœ‰ä¸€ä¸ªé™„ä»¶ï¼Œä¿æŒå‘åå…¼å®¹ï¼ˆå•ä¸ªå¯¹è±¡ï¼‰ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä½¿ç”¨åˆ—è¡¨
attachment_info = attachment_info_list[0] if len(attachment_info_list) == 1 else (attachment_info_list if attachment_info_list else None)
```

**é—®é¢˜**:
- å½“æœ‰å¤šä¸ªé™„ä»¶æ—¶ï¼Œè¿”å›åˆ—è¡¨
- ä½†åç»­å¤„ç†æ—¶å¯èƒ½åªå¤„ç†äº†ç¬¬ä¸€ä¸ª
- æˆ–è€…åˆ—è¡¨å¤„ç†é€»è¾‘æœ‰é—®é¢˜

## ğŸ” ä»£ç å…³é”®ä½ç½®

### Python æœåŠ¡ - é™„ä»¶æå–é€»è¾‘

**æ–‡ä»¶**: `ai-hub-ai/main.py`

**å…³é”®å‡½æ•°**:
1. `extract_filename_from_reference(text)` - ä»æ–‡æœ¬ä¸­æå–æ–‡ä»¶å
2. `find_attachment_file(filename)` - åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æŸ¥æ‰¾æ–‡ä»¶
3. `map_excel_row_to_article()` - æ˜ å°„Excelè¡Œåˆ°æ–‡ç« DTOï¼ŒåŒ…å«é™„ä»¶ä¿¡æ¯æå–

**å…³é”®ä»£ç ç‰‡æ®µ**:
```python
# æå–é™„ä»¶ä¿¡æ¯ï¼ˆæ”¯æŒå¤šä¸ªå¼•ç”¨ï¼‰
attachment_info_list = []
if video_reference:
    # æŒ‰æ¢è¡Œç¬¦ã€åˆ†å·åˆ†å‰²å¤šä¸ªå¼•ç”¨
    all_references = []
    for line in video_reference.split('\n'):
        parts = re.split(r'[ï¼›;]', line)
        for part in parts:
            all_references.append(part.strip())
    
    # å¦‚æœåªæœ‰ä¸€ä¸ªï¼Œå°è¯•ç”¨æ­£åˆ™æå–æ‰€æœ‰å¼•ç”¨
    if len(all_references) == 1:
        pattern = r'å‚è€ƒ["""""]([^"""""]+)["""""]'
        matches = re.findall(pattern, video_reference)
        if matches:
            all_references = [f'å‚è€ƒ"{m}"' for m in matches]
    
    # åŒ¹é…æ¯ä¸ªå¼•ç”¨
    for ref_line in all_references:
        extracted_filename = extract_filename_from_reference(ref_line)
        if extracted_filename:
            file_info = find_attachment_file(clean_extracted)
            if file_info:
                attachment_info_list.append({...})  # æ·»åŠ åˆ°åˆ—è¡¨
```

### .NET åç«¯ - é™„ä»¶åˆ›å»ºé€»è¾‘

**æ–‡ä»¶**: `ai-hub-service/Controllers/InternalApiController.cs`

**å…³é”®æ–¹æ³•**: `BatchCreateAssets()`

**å…³é”®ä»£ç ç‰‡æ®µ**:
```csharp
[HttpPost("assets/batch")]
public async Task<ActionResult<BatchCreateAssetsResponseDto>> BatchCreateAssets(
    [FromBody] BatchCreateAssetsRequestDto request)
{
    var tenantId = GetTenantId();
    for (int i = 0; i < request.Assets.Count; i++)
    {
        var asset = await _assetService.CreateAsync(assetDto, tenantId);
        // åˆ›å»ºé™„ä»¶è®°å½•åˆ°æ•°æ®åº“
    }
}
```

### å‰ç«¯ - é™„ä»¶æ˜¾ç¤ºé€»è¾‘

**æ–‡ä»¶**: `knowledgebase-frontend/src/views/KnowledgeDetail.vue`

**å…³é”®ä»£ç **:
```vue
<div v-if="item.attachments && item.attachments.length > 0" class="attachments">
  <div v-for="att in item.attachments" :key="att.id">
    <!-- æ˜¾ç¤ºé™„ä»¶ -->
  </div>
</div>
<div v-else class="no-attachments">æš‚æ— é™„ä»¶</div>
```

## ğŸ“Š æ•°æ®æµ

```
Excel å•å…ƒæ ¼: "å‚è€ƒ"141æ²¹æ³µé˜»å°¼æ‹†å¸"\nå‚è€ƒ"141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥"\nå‚è€ƒ"141æ³µé«˜ä½å‹é˜€æ‹†è§£""
  â†“
Python æå–: ["141æ²¹æ³µé˜»å°¼æ‹†å¸", "141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥", "141æ³µé«˜ä½å‹é˜€æ‹†è§£"]
  â†“
æ–‡ä»¶åŒ¹é…: 
  - "141æ²¹æ³µé˜»å°¼æ‹†å¸" â†’ æœªæ‰¾åˆ° âŒ
  - "141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥" â†’ æœªæ‰¾åˆ° âŒ
  - "141æ³µé«˜ä½å‹é˜€æ‹†è§£" â†’ æ‰¾åˆ° âœ… (æ–‡ä»¶å¤¹[141æ³µé«˜ä½å‹é˜€æ‹†è§£]/2.mp4)
  â†“
é™„ä»¶ä¿¡æ¯: [{"filename": "141æ³µé«˜ä½å‹é˜€æ‹†è§£", "url": "...", ...}]
  â†“
åˆ›å»ºæ–‡ç« : ArticleId = 348
  â†“
æ‰¹é‡åˆ›å»ºé™„ä»¶: POST /api/ai/kb/articles/assets/batch
  â†“
æ•°æ®åº“: kb_asset è¡¨æ’å…¥ 1 æ¡è®°å½•
  â†“
å‰ç«¯æŸ¥è¯¢: GET /api/knowledgeitems/348
  â†“
è¿”å›æ•°æ®: {..., "assets": [{...}]}  â† åªæœ‰ 1 ä¸ªé™„ä»¶
```

## ğŸ¯ éœ€è¦è§£å†³çš„é—®é¢˜

### ä¼˜å…ˆçº§ P0ï¼ˆé˜»å¡é—®é¢˜ï¼‰

1. **å¤šå¼•ç”¨åªåˆ›å»ºäº†ä¸€ä¸ªé™„ä»¶è®°å½•**
   - ç°è±¡ï¼šExcel æœ‰ 3 ä¸ªå¼•ç”¨ï¼Œä½†åªåˆ›å»ºäº† 1 ä¸ªé™„ä»¶
   - å½±å“ï¼šæ•°æ®ä¸å®Œæ•´ï¼Œç”¨æˆ·çœ‹ä¸åˆ°æ‰€æœ‰é™„ä»¶
   - éœ€è¦ç¡®è®¤ï¼šæ˜¯æ–‡ä»¶åŒ¹é…å¤±è´¥ï¼Œè¿˜æ˜¯é™„ä»¶ä¿¡æ¯æ”¶é›†/åˆ›å»ºé€»è¾‘æœ‰é—®é¢˜

2. **æ–‡ä»¶å­˜åœ¨ä½†åŒ¹é…å¤±è´¥**
   - ç°è±¡ï¼šæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ˆå¦‚ `400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®.docx`ï¼‰æ— æ³•åŒ¹é…
   - å½±å“ï¼šé™„ä»¶è®°å½•æ— æ³•åˆ›å»º
   - éœ€è¦ç¡®è®¤ï¼šæ–‡ä»¶åæå–ã€åŒ¹é…é€»è¾‘æ˜¯å¦æœ‰é—®é¢˜

### ä¼˜å…ˆçº§ P1ï¼ˆé‡è¦é—®é¢˜ï¼‰

3. **é™„ä»¶è®°å½•åˆ›å»ºæˆåŠŸä½†å‰ç«¯ä¸æ˜¾ç¤º**
   - ç°è±¡ï¼šæ•°æ®åº“æœ‰è®°å½•ï¼Œä½†å‰ç«¯æ˜¾ç¤º"æš‚æ— é™„ä»¶"
   - å½±å“ï¼šç”¨æˆ·æ— æ³•æŸ¥çœ‹é™„ä»¶
   - éœ€è¦ç¡®è®¤ï¼šç§Ÿæˆ·IDã€æ•°æ®åŠ è½½ã€å‰ç«¯æ˜¾ç¤ºé€»è¾‘

4. **æ—¥å¿—ä¸å¤Ÿè¯¦ç»†**
   - ç°è±¡ï¼šæ— æ³•å‡†ç¡®åˆ¤æ–­æ¯ä¸ªå¼•ç”¨æ˜¯å¦æ‰¾åˆ°æ–‡ä»¶
   - å½±å“ï¼šéš¾ä»¥å®šä½é—®é¢˜
   - å·²æ”¹è¿›ï¼šæ·»åŠ äº†æ›´è¯¦ç»†çš„æ—¥å¿—

## ğŸ”§ å½“å‰ä»£ç æ”¹è¿›

### å·²å®Œæˆçš„æ”¹è¿›

1. âœ… ä¼˜å…ˆåŒ¹é…æ ¹ç›®å½•æ–‡ä»¶
2. âœ… æ”¯æŒå¤šå¼•ç”¨æå–ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰
3. âœ… æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è®°å½•
4. âœ… ä¿®å¤ç§Ÿæˆ·IDè¿‡æ»¤é—®é¢˜
5. âœ… æ·»åŠ é™„ä»¶åˆ›å»ºç»“æœéªŒè¯

### å¾…éªŒè¯çš„æ”¹è¿›

1. â³ å¤šå¼•ç”¨åŒ¹é…ç»“æœç»Ÿè®¡
2. â³ æ–‡ä»¶åŒ¹é…å¤±è´¥æ—¶çš„è°ƒè¯•ä¿¡æ¯
3. â³ é™„ä»¶åˆ›å»ºåçš„æ•°æ®åº“éªŒè¯

## ğŸ“ æµ‹è¯•åœºæ™¯ä¸æœŸæœ›ç»“æœ

### åœºæ™¯ 1ï¼šå•ä¸ªå¼•ç”¨ï¼ˆæ ¹ç›®å½•æ–‡ä»¶ï¼‰

**è¾“å…¥**ï¼š
```
Excel å•å…ƒæ ¼: å‚è€ƒ"400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®"
æ–‡ä»¶ä½ç½®: D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®.docx
```

**æœŸæœ›ç»“æœ**ï¼š
- âœ… æå– 1 ä¸ªå¼•ç”¨
- âœ… æ‰¾åˆ°æ–‡ä»¶ï¼ˆæ ¹ç›®å½•ç²¾ç¡®åŒ¹é…ï¼‰
- âœ… åˆ›å»º 1 ä¸ªé™„ä»¶è®°å½•
- âœ… å‰ç«¯æ˜¾ç¤º 1 ä¸ªé™„ä»¶

**å®é™…ç»“æœ**ï¼š
- âŒ æœªæ‰¾åˆ°æ–‡ä»¶ï¼ˆéœ€è¦ç¡®è®¤åŸå› ï¼‰

### åœºæ™¯ 2ï¼šå•ä¸ªå¼•ç”¨ï¼ˆå­æ–‡ä»¶å¤¹æ–‡ä»¶ï¼‰

**è¾“å…¥**ï¼š
```
Excel å•å…ƒæ ¼: å‚è€ƒ"åŠ ç ‚çƒé˜€æ¸…æŒ¤ç ‚"
æ–‡ä»¶ä½ç½®: D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\åŠ ç ‚çƒé˜€æ¸…æŒ¤ç ‚\æ‹†ä¸‹æ³•å…°.jpg
```

**æœŸæœ›ç»“æœ**ï¼š
- âœ… æå– 1 ä¸ªå¼•ç”¨
- âœ… æ‰¾åˆ°æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹åç§°åŒ¹é…ï¼‰
- âœ… åˆ›å»º 1 ä¸ªé™„ä»¶è®°å½•
- âœ… å‰ç«¯æ˜¾ç¤º 1 ä¸ªé™„ä»¶

**å®é™…ç»“æœ**ï¼š
- âœ… æ­£å¸¸å·¥ä½œ

### åœºæ™¯ 3ï¼šå¤šä¸ªå¼•ç”¨ï¼ˆæ¢è¡Œåˆ†éš”ï¼‰

**è¾“å…¥**ï¼š
```
Excel å•å…ƒæ ¼: 
å‚è€ƒ"141æ²¹æ³µé˜»å°¼æ‹†å¸"
å‚è€ƒ"141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥"
å‚è€ƒ"141æ³µé«˜ä½å‹é˜€æ‹†è§£"

æ–‡ä»¶ä½ç½®:
- D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\141æ²¹æ³µé˜»å°¼æ‹†å¸.mp4 (æ ¹ç›®å½•)
- D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥.jpg (æ ¹ç›®å½•)
- D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\141æ³µé«˜ä½å‹é˜€æ‹†è§£\2.mp4 (å­æ–‡ä»¶å¤¹)
```

**æœŸæœ›ç»“æœ**ï¼š
- âœ… æå– 3 ä¸ªå¼•ç”¨
- âœ… æ‰¾åˆ° 3 ä¸ªæ–‡ä»¶
- âœ… åˆ›å»º 3 ä¸ªé™„ä»¶è®°å½•
- âœ… å‰ç«¯æ˜¾ç¤º 3 ä¸ªé™„ä»¶

**å®é™…ç»“æœ**ï¼š
- âš ï¸ æå– 3 ä¸ªå¼•ç”¨
- âŒ åªæ‰¾åˆ° 1 ä¸ªæ–‡ä»¶ï¼ˆå…¶ä»– 2 ä¸ªæœªæ‰¾åˆ°ï¼‰
- âŒ åªåˆ›å»º 1 ä¸ªé™„ä»¶è®°å½•
- âŒ å‰ç«¯åªæ˜¾ç¤º 1 ä¸ªé™„ä»¶

### åœºæ™¯ 4ï¼šå¤šä¸ªå¼•ç”¨ï¼ˆåŒä¸€è¡Œï¼Œç”¨åˆ†å·åˆ†éš”ï¼‰

**è¾“å…¥**ï¼š
```
Excel å•å…ƒæ ¼: å‚è€ƒ"400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®"ï¼›å‚è€ƒ"æ›´æ¢å°çƒé˜€å¯†å°åœˆ"
```

**æœŸæœ›ç»“æœ**ï¼š
- âœ… æå– 2 ä¸ªå¼•ç”¨
- âœ… æ‰¾åˆ° 2 ä¸ªæ–‡ä»¶
- âœ… åˆ›å»º 2 ä¸ªé™„ä»¶è®°å½•

**å®é™…ç»“æœ**ï¼š
- å¾…æµ‹è¯•

## ğŸ“ æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šå•ä¸ªå¼•ç”¨
```
Excel: å‚è€ƒ"åŠ ç ‚çƒé˜€æ¸…æŒ¤ç ‚"
é¢„æœŸ: æ‰¾åˆ°æ–‡ä»¶ï¼Œåˆ›å»º 1 ä¸ªé™„ä»¶è®°å½•
```

### åœºæ™¯ 2ï¼šå¤šä¸ªå¼•ç”¨ï¼ˆæ¢è¡Œåˆ†éš”ï¼‰
```
Excel: å‚è€ƒ"141æ²¹æ³µé˜»å°¼æ‹†å¸"\nå‚è€ƒ"141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥"\nå‚è€ƒ"141æ³µé«˜ä½å‹é˜€æ‹†è§£"
é¢„æœŸ: æ‰¾åˆ°æ‰€æœ‰æ–‡ä»¶ï¼Œåˆ›å»º 3 ä¸ªé™„ä»¶è®°å½•
å®é™…: åªåˆ›å»ºäº† 1 ä¸ªé™„ä»¶è®°å½• âŒ
```

### åœºæ™¯ 3ï¼šæ ¹ç›®å½•æ–‡ä»¶
```
Excel: å‚è€ƒ"400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®"
æ–‡ä»¶ä½ç½®: D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®.docx
é¢„æœŸ: æ‰¾åˆ°æ–‡ä»¶ï¼Œåˆ›å»ºé™„ä»¶è®°å½•
å®é™…: æœªæ‰¾åˆ°æ–‡ä»¶ âŒ
```

### åœºæ™¯ 4ï¼šæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶
```
Excel: å‚è€ƒ"åŠ ç ‚çƒé˜€æ¸…æŒ¤ç ‚"
æ–‡ä»¶ä½ç½®: D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\åŠ ç ‚çƒé˜€æ¸…æŒ¤ç ‚\æ‹†ä¸‹æ³•å…°.jpg
é¢„æœŸ: æ‰¾åˆ°æ–‡ä»¶ï¼Œåˆ›å»ºé™„ä»¶è®°å½•
å®é™…: æ‰¾åˆ°æ–‡ä»¶ï¼Œåˆ›å»ºæˆåŠŸ âœ…
```

## ğŸ¯ æ ¸å¿ƒé—®é¢˜æ€»ç»“

### é—®é¢˜ Aï¼šå¤šå¼•ç”¨å¤„ç†ä¸å®Œæ•´

**ç°è±¡**ï¼š
- Excel å•å…ƒæ ¼ï¼š`å‚è€ƒ"141æ²¹æ³µé˜»å°¼æ‹†å¸"\nå‚è€ƒ"141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥"\nå‚è€ƒ"141æ³µé«˜ä½å‹é˜€æ‹†è§£"`
- æ—¥å¿—æ˜¾ç¤ºï¼š`æ£€æµ‹åˆ° 3 ä¸ªå¼•ç”¨`
- å®é™…ç»“æœï¼šåªåˆ›å»ºäº† 1 ä¸ªé™„ä»¶è®°å½•

**å…³é”®ç–‘é—®**ï¼š
1. å…¶ä»– 2 ä¸ªå¼•ç”¨æ˜¯å¦æ‰¾åˆ°äº†æ–‡ä»¶ï¼Ÿ
2. å¦‚æœæ‰¾åˆ°äº†ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰åˆ›å»ºé™„ä»¶è®°å½•ï¼Ÿ
3. å¦‚æœæ²¡æ‰¾åˆ°ï¼Œä¸ºä»€ä¹ˆæ–‡ä»¶åŒ¹é…å¤±è´¥ï¼Ÿ

### é—®é¢˜ Bï¼šæ ¹ç›®å½•æ–‡ä»¶åŒ¹é…å¤±è´¥

**ç°è±¡**ï¼š
- æ–‡ä»¶ç¡®å®å­˜åœ¨ï¼š`D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘\400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®.docx`
- Excel å¼•ç”¨ï¼š`å‚è€ƒ"400çƒé˜€å¯†å°èƒ¶åœˆå®‰è£…ç»´ä¿®"`
- åŒ¹é…ç»“æœï¼šæœªæ‰¾åˆ°æ–‡ä»¶

**å…³é”®ç–‘é—®**ï¼š
1. æ–‡ä»¶åæå–æ˜¯å¦æ­£ç¡®ï¼Ÿ
2. æ–‡ä»¶åŒ¹é…é€»è¾‘æ˜¯å¦æ£€æŸ¥äº†æ ¹ç›®å½•ï¼Ÿ
3. æ˜¯å¦æœ‰ç¼–ç æˆ–å¤§å°å†™é—®é¢˜ï¼Ÿ

### é—®é¢˜ Cï¼šé™„ä»¶è®°å½•åˆ›å»ºæˆåŠŸä½†å‰ç«¯ä¸æ˜¾ç¤º

**ç°è±¡**ï¼š
- æ—¥å¿—æ˜¾ç¤ºï¼š`âœ… é™„ä»¶åˆ›å»ºç»“æœ: æˆåŠŸ 6 ä¸ª`
- æ•°æ®åº“æŸ¥è¯¢ï¼šæœ‰ 6 æ¡è®°å½•
- å‰ç«¯æ˜¾ç¤ºï¼š`æš‚æ— é™„ä»¶`

**å…³é”®ç–‘é—®**ï¼š
1. å‰ç«¯æŸ¥è¯¢æ—¶ç§Ÿæˆ·IDæ˜¯å¦ä¸€è‡´ï¼Ÿ
2. é™„ä»¶æ˜¯å¦è¢«è½¯åˆ é™¤ï¼Ÿ
3. API è¿”å›çš„æ•°æ®ç»“æ„æ˜¯å¦æ­£ç¡®ï¼Ÿ

## ğŸ’¡ è¯·æ±‚ ChatGPT åˆ†æçš„é—®é¢˜

1. **å¤šå¼•ç”¨å¤„ç†é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Ÿ**
   - ä¸ºä»€ä¹ˆæ£€æµ‹åˆ° 3 ä¸ªå¼•ç”¨ï¼Œä½†åªåˆ›å»ºäº† 1 ä¸ªé™„ä»¶è®°å½•ï¼Ÿ
   - æ˜¯æ–‡ä»¶åŒ¹é…å¤±è´¥ï¼Œè¿˜æ˜¯é™„ä»¶ä¿¡æ¯æ”¶é›†/åˆ›å»ºé€»è¾‘æœ‰é—®é¢˜ï¼Ÿ

2. **æ–‡ä»¶åŒ¹é…é€»è¾‘æ˜¯å¦æœ‰é—æ¼ï¼Ÿ**
   - ä¸ºä»€ä¹ˆæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶æ— æ³•åŒ¹é…ï¼Ÿ
   - æ–‡ä»¶åæå–ã€æ¸…ç†ã€åŒ¹é…çš„æ¯ä¸ªæ­¥éª¤æ˜¯å¦æ­£ç¡®ï¼Ÿ

3. **é™„ä»¶ä¿¡æ¯ä¼ é€’é“¾è·¯æ˜¯å¦å®Œæ•´ï¼Ÿ**
   - ä» Python æå– â†’ æ”¶é›† â†’ æ‰¹é‡åˆ›å»ºï¼Œæ•°æ®æ˜¯å¦æ­£ç¡®ä¼ é€’ï¼Ÿ
   - æ˜¯å¦æœ‰æ•°æ®ä¸¢å¤±æˆ–è½¬æ¢é”™è¯¯ï¼Ÿ

4. **å‰ç«¯æ˜¾ç¤ºé—®é¢˜å¯èƒ½çš„åŸå› ï¼Ÿ**
   - å¦‚æœæ•°æ®åº“æœ‰è®°å½•ä½†å‰ç«¯ä¸æ˜¾ç¤ºï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ
   - å¦‚ä½•éªŒè¯æ•°æ®æµæ˜¯å¦å®Œæ•´ï¼Ÿ

5. **å¦‚ä½•æ”¹è¿›å½“å‰å®ç°ï¼Ÿ**
   - æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ¡ˆæ¥å¤„ç†å¤šå¼•ç”¨ï¼Ÿ
   - å¦‚ä½•æé«˜æ–‡ä»¶åŒ¹é…çš„å‡†ç¡®æ€§ï¼Ÿ
   - å¦‚ä½•ç¡®ä¿é™„ä»¶è®°å½•çš„å®Œæ•´æ€§ï¼Ÿ

## ğŸ“ ç›¸å…³æ–‡ä»¶

- Python æœåŠ¡: `ai-hub-ai/main.py` (ç¬¬ 407-470 è¡Œï¼šé™„ä»¶æå–é€»è¾‘)
- .NET åç«¯: `ai-hub-service/Controllers/InternalApiController.cs` (ç¬¬ 124-186 è¡Œï¼šæ‰¹é‡åˆ›å»ºé™„ä»¶)
- .NET æœåŠ¡: `ai-hub-service/Services/AssetService.cs` (ç¬¬ 173-218 è¡Œï¼šåˆ›å»ºé™„ä»¶è®°å½•)
- å‰ç«¯æ˜¾ç¤º: `knowledgebase-frontend/src/views/KnowledgeDetail.vue` (ç¬¬ 78-118 è¡Œï¼šé™„ä»¶æ˜¾ç¤º)

## ğŸ“‹ å…³é”®ä»£ç ç‰‡æ®µ

### Python - å¤šå¼•ç”¨æå–é€»è¾‘

```python
# å¦‚æœæŒ‰åˆ†éš”ç¬¦åˆ†å‰²ååªæœ‰ä¸€ä¸ªï¼Œå°è¯•ä»æ–‡æœ¬ä¸­æå–æ‰€æœ‰"å‚è€ƒ"xxx""æ ¼å¼çš„å¼•ç”¨
if len(all_references) == 1:
    # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–æ‰€æœ‰"å‚è€ƒ"xxx""æ ¼å¼çš„å¼•ç”¨
    pattern = r'å‚è€ƒ["""""]([^"""""]+)["""""]'
    matches = re.findall(pattern, video_reference)
    if matches:
        all_references = [f'å‚è€ƒ"{m}"' for m in matches]

# åŒ¹é…æ¯ä¸ªå¼•ç”¨
for idx, ref_line in enumerate(all_references, 1):
    extracted_filename = extract_filename_from_reference(ref_line)
    if extracted_filename:
        clean_extracted = extracted_filename.strip('"""\'"ã€Šã€‹ã€ã€‘[]()ï¼ˆï¼‰').strip()
        file_info = find_attachment_file(clean_extracted)
        if file_info:
            attachment_info_list.append({...})  # æ·»åŠ åˆ°åˆ—è¡¨
            matched_count += 1
            logger.info(f"âœ“ [{idx}/{len(all_references)}] æ‰¾åˆ°é™„ä»¶: {clean_extracted}")
        else:
            logger.warning(f"âœ— [{idx}/{len(all_references)}] æœªæ‰¾åˆ°é™„ä»¶: {clean_extracted}")

# è¿”å›é™„ä»¶ä¿¡æ¯ï¼ˆå•ä¸ªå¯¹è±¡æˆ–åˆ—è¡¨ï¼‰
attachment_info = attachment_info_list[0] if len(attachment_info_list) == 1 else (attachment_info_list if attachment_info_list else None)
```

### Python - æ‰¹é‡åˆ›å»ºé™„ä»¶é€»è¾‘

```python
# æ”¶é›†æˆåŠŸåˆ›å»ºçš„ article IDs å’Œé™„ä»¶ä¿¡æ¯
article_id_to_attachments = {}
for i, item in enumerate(result.get("results", [])):
    if item.get("success") and item.get("articleId"):
        article_id = item["articleId"]
        att_info = articles_with_attachments[i].get("_attachment_info")
        if att_info:
            # å¦‚æœæ˜¯åˆ—è¡¨ï¼Œç›´æ¥ä½¿ç”¨ï¼›å¦‚æœæ˜¯å•ä¸ªå¯¹è±¡ï¼Œè½¬æ¢ä¸ºåˆ—è¡¨
            if isinstance(att_info, list):
                article_id_to_attachments[article_id] = att_info
            else:
                article_id_to_attachments[article_id] = [att_info]

# æ‰¹é‡åˆ›å»ºé™„ä»¶
for article_id, att_info_list in article_id_to_attachments.items():
    for att_info in att_info_list:
        assets_to_create.append({
            "articleId": article_id,
            "assetType": att_info["asset_type"],
            "fileName": att_info["file_name"],
            "url": att_info["url"],
            "size": att_info["size"]
        })
```

### .NET - é™„ä»¶åˆ›å»ºéªŒè¯

```csharp
// éªŒè¯çŸ¥è¯†æ¡ç›®æ˜¯å¦å­˜åœ¨ä¸”å±äºå½“å‰ç§Ÿæˆ·
var article = await _context.KnowledgeArticles
    .Where(a => a.Id == createDto.ArticleId && a.TenantId == tenantId && a.DeletedAt == null)
    .FirstOrDefaultAsync();
if (article == null)
    throw new UnauthorizedAccessException($"çŸ¥è¯†æ¡ç›® {createDto.ArticleId} ä¸å­˜åœ¨æˆ–ä¸å±äºå½“å‰ç§Ÿæˆ·");

// åˆ›å»ºé™„ä»¶è®°å½•
var asset = new Asset
{
    TenantId = tenantId,
    ArticleId = createDto.ArticleId,
    AssetType = createDto.AssetType,
    FileName = createDto.FileName,
    Url = createDto.Url,
    Size = createDto.Size,
    CreatedAt = DateTime.Now
};

_context.Assets.Add(asset);
await _context.SaveChangesAsync();  // å†™å…¥æ•°æ®åº“
```

## ğŸ“Š å®é™…æ—¥å¿—ç¤ºä¾‹

### æˆåŠŸçš„æ¡ˆä¾‹

```
INFO:__main__:æ£€æµ‹åˆ° 2 ä¸ªå¼•ç”¨ï¼Œå°†å°è¯•åŒ¹é…æ‰€æœ‰å¼•ç”¨
INFO:__main__:âœ“ [1/2] æ‰¾åˆ°é™„ä»¶: æ­£æ¿æ»‘é´è°ƒæ•´ -> http://localhost:5000/uploads/...
INFO:__main__:âœ“ [2/2] æ‰¾åˆ°é™„ä»¶: æ­£æ¿å‚ç›´åº¦æ£€æµ‹ -> http://localhost:5000/uploads/...
INFO:__main__:å¤šå¼•ç”¨åŒ¹é…ç»“æœ: 2/2 ä¸ªå¼•ç”¨æ‰¾åˆ°æ–‡ä»¶
INFO:__main__:å‡†å¤‡åˆ›å»º 2 ä¸ªé™„ä»¶è®°å½•ï¼ˆæ¶‰åŠ 1 ç¯‡æ–‡ç« ï¼‰
INFO:__main__:  æ–‡ç«  ID 335: 2 ä¸ªé™„ä»¶
INFO:__main__:âœ… é™„ä»¶åˆ›å»ºç»“æœ: æˆåŠŸ 2 ä¸ªï¼Œå¤±è´¥ 0 ä¸ª
```

### å¤±è´¥çš„æ¡ˆä¾‹

```
INFO:__main__:æ£€æµ‹åˆ° 3 ä¸ªå¼•ç”¨ï¼Œå°†å°è¯•åŒ¹é…æ‰€æœ‰å¼•ç”¨
INFO:__main__:âœ— [1/3] æœªæ‰¾åˆ°é™„ä»¶: 141æ²¹æ³µé˜»å°¼æ‹†å¸ (åŸå§‹å¼•ç”¨: å‚è€ƒ"141æ²¹æ³µé˜»å°¼æ‹†å¸")
INFO:__main__:âœ— [2/3] æœªæ‰¾åˆ°é™„ä»¶: 141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥ (åŸå§‹å¼•ç”¨: å‚è€ƒ"141æ²¹æ³µæº¢æµé˜€æ£€æŸ¥")
INFO:__main__:âœ“ [3/3] æ‰¾åˆ°é™„ä»¶: 141æ³µé«˜ä½å‹é˜€æ‹†è§£ -> http://localhost:5000/uploads/...
INFO:__main__:å¤šå¼•ç”¨åŒ¹é…ç»“æœ: 1/3 ä¸ªå¼•ç”¨æ‰¾åˆ°æ–‡ä»¶
INFO:__main__:å‡†å¤‡åˆ›å»º 1 ä¸ªé™„ä»¶è®°å½•ï¼ˆæ¶‰åŠ 1 ç¯‡æ–‡ç« ï¼‰  â† åªåˆ›å»ºäº† 1 ä¸ª
INFO:__main__:  æ–‡ç«  ID 348: 1 ä¸ªé™„ä»¶
```

## ğŸ” è°ƒè¯•å»ºè®®

### 1. éªŒè¯æ–‡ä»¶åŒ¹é…

åœ¨ Python æœåŠ¡ä¸­æ·»åŠ ä¸´æ—¶è°ƒè¯•ä»£ç ï¼š

```python
# åœ¨ find_attachment_file å‡½æ•°ä¸­æ·»åŠ 
logger.info(f"æœç´¢æ–‡ä»¶: {clean_filename}, åŸºç¡€è·¯å¾„: {base_path}")
logger.info(f"å°è¯•åŒ¹é…: {full_filename}")
matches = list(base_path.rglob(full_filename))
logger.info(f"æ‰¾åˆ° {len(matches)} ä¸ªåŒ¹é…æ–‡ä»¶: {[str(m) for m in matches]}")
```

### 2. éªŒè¯é™„ä»¶ä¿¡æ¯æ”¶é›†

åœ¨ `map_excel_row_to_article` å‡½æ•°è¿”å›å‰æ·»åŠ ï¼š

```python
if attachment_info_list:
    logger.info(f"æ”¶é›†åˆ° {len(attachment_info_list)} ä¸ªé™„ä»¶ä¿¡æ¯: {[a['filename'] for a in attachment_info_list]}")
```

### 3. éªŒè¯æ‰¹é‡åˆ›å»ºè¯·æ±‚

åœ¨è°ƒç”¨æ‰¹é‡åˆ›å»ºAPIå‰æ·»åŠ ï¼š

```python
logger.info(f"å‡†å¤‡å‘é€æ‰¹é‡åˆ›å»ºè¯·æ±‚: {len(assets_to_create)} ä¸ªé™„ä»¶")
for idx, asset in enumerate(assets_to_create):
    logger.info(f"  é™„ä»¶ [{idx}]: ArticleId={asset['articleId']}, FileName={asset['fileName']}, Url={asset['url']}")
```

### 4. éªŒè¯æ•°æ®åº“è®°å½•

```sql
-- æŸ¥çœ‹æ‰€æœ‰é™„ä»¶è®°å½•
SELECT 
    id,
    article_id,
    file_name,
    url,
    asset_type,
    tenant_id,
    created_at,
    deleted_at
FROM kb_asset
WHERE tenant_id = 'default'
ORDER BY created_at DESC;

-- æŸ¥çœ‹ç‰¹å®šæ–‡ç« çš„é™„ä»¶
SELECT * FROM kb_asset 
WHERE article_id = 348 
  AND tenant_id = 'default' 
  AND deleted_at IS NULL;
```

## âš™ï¸ ç¯å¢ƒé…ç½®

### Python æœåŠ¡é…ç½®

**æ–‡ä»¶**: `ai-hub-ai/.env`

```env
DOTNET_BASE_URL=http://localhost:5000
INTERNAL_TOKEN=test-token-123
DEFAULT_TENANT=default
ATTACHMENT_BASE_PATH=D:\01-èµ„æ–™\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘
ATTACHMENT_BASE_URL=http://localhost:5000/uploads
```

### .NET åç«¯é…ç½®

**æ–‡ä»¶**: `ai-hub-service/appsettings.json`

```json
{
  "InternalToken": "test-token-123",
  "AttachmentStorage": {
    "BasePath": "D:\\01-èµ„æ–™\\æ°¸çº¢é€ å‹çº¿ç»´ä¿®è§†é¢‘",
    "BaseUrl": "http://localhost:5000/uploads"
  }
}
```

### æ•°æ®åº“è¡¨ç»“æ„

**è¡¨**: `kb_asset`

```sql
CREATE TABLE kb_asset (
    id INT PRIMARY KEY IDENTITY(1,1),
    tenant_id NVARCHAR(50) NOT NULL,
    article_id INT NOT NULL,
    asset_type NVARCHAR(20) NOT NULL,  -- image/video/pdf/other
    file_name NVARCHAR(500) NOT NULL,
    url NVARCHAR(1000) NOT NULL,
    size BIGINT,
    duration INT,
    created_at DATETIME NOT NULL,
    deleted_at DATETIME NULL,
    FOREIGN KEY (article_id) REFERENCES kb_article(id)
);
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- `ATTACHMENT_STRATEGY.md` - é™„ä»¶å¤„ç†ç­–ç•¥
- `ATTACHMENT_CREATION_FLOW.md` - é™„ä»¶åˆ›å»ºæµç¨‹è¯´æ˜
- `FILE_NAMING_GUIDE.md` - æ–‡ä»¶å‘½åè§„èŒƒæŒ‡å—
