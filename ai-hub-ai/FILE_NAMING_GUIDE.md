# 附件文件命名规范指南

## 📋 问题分析

当前附件文件命名存在多种不规范情况，导致 Excel 导入时难以自动匹配：

1. **描述性名称**：`主泵高低压阀清洗1.mp4` ✅ 可匹配
2. **数字编号**：`1.jpg`、`2.jpg`、`3.jpg` ❌ 无法匹配
3. **哈希值**：`a0a2fde1c5d10292845fe86506b0099a.mp4` ❌ 无法匹配
4. **文件夹名称**：`加砂球阀清挤砂`（文件夹内可能有文件）⚠️ 需要特殊处理

## 🎯 推荐命名模板

### 方案 A：描述性命名（推荐）

**格式**：`{设备型号}_{故障现象/操作名称}_{序号}.{扩展名}`

**示例**：
- ✅ `YH400_加砂球阀清挤砂_1.mp4`
- ✅ `YH500_下芯机比例阀拆解.mp4`
- ✅ `141泵_压力调整.mp4`
- ✅ `反板_翻转轴承拆解.mp4`

**优点**：
- 与 Excel 中的引用名称高度一致
- 易于人工识别和管理
- 支持自动匹配

### 方案 B：文件夹 + 描述性文件名

**结构**：
```
永红造型线维修视频/
  ├── 加砂球阀清挤砂/          ← 文件夹名称 = Excel 引用名称
  │   ├── 操作步骤1.mp4
  │   ├── 操作步骤2.jpg
  │   └── 注意事项.docx
  ├── 下芯机比例阀拆解/
  │   └── 拆解视频.mp4
```

**优点**：
- 文件夹名称与 Excel 引用一致
- 文件夹内文件可自由命名
- 支持一个主题多个文件

### 方案 C：混合模式（当前推荐）

**规则**：
1. **优先使用描述性文件名**（方案 A）
2. **如果文件在文件夹中，文件夹名称必须与 Excel 引用匹配**
3. **文件夹内的文件可以自由命名**（如 `1.mp4`、`步骤1.jpg`）

## 🔧 当前系统匹配策略

系统已实现以下匹配策略（按优先级）：

### 1. 精确匹配
- 搜索文件名完全匹配的文件
- 例如：Excel 引用 `加砂球阀清挤砂` → 匹配 `加砂球阀清挤砂.mp4`

### 2. 模糊匹配
- 搜索文件名包含关键字的文件
- 例如：Excel 引用 `下芯机比例阀拆解` → 匹配 `下芯机比例阀拆装.mp4`

### 3. 文件夹名称匹配（待实现）
- 如果找不到文件，尝试匹配文件夹名称
- 如果文件夹名称匹配，返回文件夹内的第一个文件（或所有文件）

## 📝 命名规范建议

### 必须遵循的规则

1. **文件名或文件夹名必须包含 Excel 中引用的关键字**
   - ✅ 正确：Excel 引用 `加砂球阀清挤砂`，文件名为 `加砂球阀清挤砂.mp4` 或文件夹名为 `加砂球阀清挤砂`
   - ❌ 错误：Excel 引用 `加砂球阀清挤砂`，文件名为 `1.mp4` 或 `a0a2fde1c5d10292845fe86506b0099a.mp4`

2. **避免使用纯数字或哈希值作为文件名**
   - ❌ `1.mp4`、`2.jpg`
   - ❌ `a0a2fde1c5d10292845fe86506b0099a.mp4`

3. **保持命名一致性**
   - 同一类文件使用相同的命名风格
   - 例如：所有视频都用 `{操作名称}.mp4` 格式

### 推荐格式

**视频文件**：
```
{操作名称}.mp4
{设备}_{故障现象}.mp4
{设备}_{操作步骤}_{序号}.mp4
```

**图片文件**：
```
{操作名称}_{序号}.jpg
{设备}_{故障现象}_{序号}.jpg
```

**文档文件**：
```
{操作名称}.docx
{设备}_{故障现象}_说明.docx
```

## 🚀 实施建议

### 短期方案（立即可用）

1. **手动重命名关键文件**
   - 将 Excel 中经常引用的文件重命名为描述性名称
   - 例如：`1.mp4` → `加砂球阀清挤砂.mp4`

2. **使用文件夹结构**
   - 创建与 Excel 引用名称一致的文件夹
   - 将相关文件放入对应文件夹

3. **建立映射表**（可选）
   - 创建一个 Excel 或 JSON 文件，记录"Excel 引用名称" → "实际文件路径"的映射关系

### 长期方案（系统改进）

1. **实现文件夹名称匹配**
   - 系统自动识别文件夹名称匹配的情况
   - 支持一个文件夹对应多个附件

2. **建立文件索引**
   - 定期扫描附件目录，建立文件名索引
   - 支持更智能的模糊匹配

3. **提供重命名工具**
   - 开发批量重命名工具，帮助规范化现有文件

## 📊 当前匹配成功率

根据您的文件命名情况：

- **描述性名称**：✅ 可匹配（如 `主泵高低压阀清洗1.mp4`）
- **文件夹名称**：⚠️ 部分匹配（需要改进）
- **数字编号**：❌ 无法匹配（如 `1.jpg`、`2.jpg`）
- **哈希值**：❌ 无法匹配（如 `a0a2fde1c5d10292845fe86506b0099a.mp4`）

## 💡 最佳实践

1. **新文件命名**：使用描述性名称，与 Excel 引用保持一致
2. **旧文件处理**：逐步重命名，或使用文件夹结构组织
3. **Excel 引用**：尽量使用实际的文件名或文件夹名
4. **定期维护**：保持文件命名的一致性

## 🔄 下一步行动

1. ✅ 系统已支持精确匹配和模糊匹配
2. 🔄 实现文件夹名称匹配（进行中）
3. ⏳ 建立文件索引系统（计划中）
4. ⏳ 提供批量重命名工具（计划中）
